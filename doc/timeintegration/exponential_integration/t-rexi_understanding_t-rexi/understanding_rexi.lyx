#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{babel}
\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding iso8859-15
\fontencoding T1
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 2
\use_package amssymb 0
\use_package cancel 0
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Understanding Terry's Rational Approximation of the Exponential Integrator
 (T-REXI)
\end_layout

\begin_layout Author
Martin Schreiber <M.Schreiber@exeter.ac.uk>
\begin_inset Newline newline
\end_inset

 Pedro S.
 Peixoto <pedrosp@ime.usp.br>
\end_layout

\begin_layout Standard
This document serves as the basis for implementing Terry's Rational approximatio
n of the EXponential Integrator (T-REXI).
 Here, we purely focus on the linear part of the shallow-water equations
 (SWE) and show the different steps to approximate solving this linear part
 with an exponential integrator.
 This paper mainly summarises previous work on REXI.
\end_layout

\begin_layout Section
Problem formulation
\end_layout

\begin_layout Standard
We use linearised shallow water equations (SWE) with respect to a rest state
 with mean water depth of 
\begin_inset Formula $\eta_{0}$
\end_inset

 and defined for perturbations of height 
\begin_inset Formula $\eta$
\end_inset

 (see 
\begin_inset CommandInset citation
LatexCommand cite
key "Schreiber:Formulations of the shallow-water equations"
literal "true"

\end_inset

).
 The linear operator (
\begin_inset Formula $L$
\end_inset

) may be written as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
L(U):=\left(\begin{array}{ccc}
0 & -\eta_{0}\partial_{x} & -\eta_{0}\partial_{y}\\
-g\partial_{x} & 0 & f\\
-g\partial_{y} & -f & 0
\end{array}\right)U
\]

\end_inset

where 
\begin_inset Formula $U:=(\eta,u,v)^{T}$
\end_inset

.
 Here, we neglect all non-linear terms and consider 
\begin_inset Formula $f$
\end_inset

 constant (f-plane approximation).
 The time evolution of the PDE, with the subscript 
\begin_inset Formula $t$
\end_inset

 denoting the derivative in time, is given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
U_{t}=L(U).
\]

\end_inset

It is further worth noting, that this system describes an oscillatory system
 (2D wave equation), hence the operator 
\begin_inset Formula $L$
\end_inset

 is hyperbolic and has imaginary eigenvalues.
 Linear initial value differential problems are well known to be solvable
 with exponential integrators for arbitrary time step sizes via 
\begin_inset Formula 
\[
U(t)=e^{Lt}U(0).
\]

\end_inset

see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Moler:Nineteen Dubious Ways to Compute the Exponential of a Matrix"
literal "true"

\end_inset

.
 However, this is typically quite expensive to compute and analytic solutions
 only exist for some simplified system of equations, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Schreiber:Formulations of the shallow-water equations"
literal "true"

\end_inset

 for f-plane shallow-water equations.
 These exponential integrators can be approximated with rational functions
 and this paper is on giving insight into this approximation.
\end_layout

\begin_layout Section
1D rational approximation
\end_layout

\begin_layout Standard
Terry et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Terry:High-order time-parallel approximation of evolution operators"
literal "true"

\end_inset

 developed a rational approximation of the exponential integrator.
 First, we like to get more insight into it with a one-dimensional formulation
 before applying REXI to a rational approximation of a linear operator.
 Our main target is to find an approximation of an operator with a 
\emph on
complex exponential shape
\emph default
, in our case 
\begin_inset Formula $e^{ix}$
\end_inset

, which (in one-dimension) is given as a function 
\begin_inset Formula $f(x)$
\end_inset

.
 We will end up in an approximation given by the following rational approximatio
n:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
e^{ix}\approx\sum_{n=-N}^{N}Re\left(\frac{\beta_{n}}{ix+\alpha_{n}}\right)
\]

\end_inset

with complex coefficients 
\begin_inset Formula $\alpha_{n}$
\end_inset

 and 
\begin_inset Formula $\beta_{n}$
\end_inset

.
 We point out that the coefficients 
\begin_inset Formula $\alpha_{n}$
\end_inset

 will always have non zero real part, so no singularity occurs with the
 rational function.
\end_layout

\begin_layout Subsection
Step A: Approximation of solution space
\end_layout

\begin_layout Standard
First, we assume that we can use Gaussian curves as basis functions for
 our approximation.
 So first we find an approximation of one of our underlying Gaussian basis
 function
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\psi_{h}(x):=(4\pi)^{-\frac{1}{2}}e^{-x^{2}/(4h^{2})}
\]

\end_inset


\end_layout

\begin_layout Standard
In this formulation, 
\begin_inset Formula $h$
\end_inset

 can be interpreted as the horizontal 
\begin_inset Quotes eld
\end_inset

stretching
\begin_inset Quotes erd
\end_inset

 of the basis function.
 Note the similarities to the Gaussian distribution, but by dropping certain
 parts of the vertical scaling as it is required for probability distributions.
 We can now approximate our function 
\begin_inset Formula $f(x)$
\end_inset

 with a superposition of basis functions 
\begin_inset Formula $\psi_{h}(x)$
\end_inset

 by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f(x)\approx\sum_{m=-M}^{M}b_{m}\psi_{h}(x+mh)
\]

\end_inset

with 
\begin_inset Formula $M$
\end_inset

 controlling the interval of approximation (~size of 
\begin_inset Quotes eld
\end_inset

domain of interest
\begin_inset Quotes erd
\end_inset

) and 
\begin_inset Formula $h$
\end_inset

 will be related to the accuracy of integration (~resolution in 
\begin_inset Quotes eld
\end_inset

domain of interest
\begin_inset Quotes erd
\end_inset

).
 We choose 
\begin_inset Formula $h$
\end_inset

 small enough so that the support of the Fourier transform of 
\begin_inset Formula $f$
\end_inset

 is mainly localised within 
\begin_inset Formula $[-1/(2h),1/(2h)]$
\end_inset

, i.e.
 almost zero outside this interval.
 
\begin_inset Formula $M$
\end_inset

 is chosen such that the approximation will be adequate in the interval
 
\begin_inset Formula $|x|<Mh$
\end_inset

.
\end_layout

\begin_layout Standard
To compute the coefficients 
\begin_inset Formula $b_{m}$
\end_inset

, we rewrite the previous equation in Fourier space with 
\begin_inset Formula 
\[
\frac{\hat{f}(\xi)}{\hat{\psi}_{h}(\xi)}=\sum_{m=\infty}^{\infty}b_{m}e^{2\pi imh\xi},
\]

\end_inset

where the 
\begin_inset Formula $\hat{\cdot}$
\end_inset

 symbols indicate the Fourier transforms of the respective functions.
 The 
\begin_inset Formula $b_{m}$
\end_inset

 are now the Fourier coefficients of the series for the function 
\begin_inset Formula $\frac{\hat{f}(\xi)}{\hat{\psi_{h}}(\xi)}$
\end_inset

 and can be calculated as (see 
\begin_inset CommandInset citation
LatexCommand cite
key "Terry:High-order time-parallel approximation of evolution operators"
literal "true"

\end_inset

, page 11), 
\begin_inset Formula 
\[
b_{m}=h\intop_{-\frac{1}{2h}}^{\frac{1}{2h}}e^{-2\pi imh\xi}\frac{\hat{f}(\xi)}{\hat{\psi_{h}}(\xi)}d\xi,
\]

\end_inset

for 
\begin_inset Formula $m$
\end_inset

 integer and 
\begin_inset Formula $1/h$
\end_inset

 defines the periodicity of the trigonometric basis function.
 The reformulation from the discrete sum over this formulation can be understood
 by a Riemann integral over one of the intervals.
 Therefore, we also don't require the translated Gaussian since the integrated
 interval is already shifted to the origin.
\end_layout

\begin_layout Standard
Since we are interested in approximating 
\begin_inset Formula $f(x)=e^{ix}$
\end_inset

, we can simplify the equation by using the response in frequency space
 
\begin_inset Formula $\hat{f}(\xi)=\delta(\xi-\frac{1}{2\pi})$
\end_inset

, where here 
\begin_inset Formula $\delta$
\end_inset

 is the Dirac distribution, and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
b_{m}=h\,e^{-imh}\hat{\psi_{h}}\left(\frac{1}{2\pi}\right)^{-1}.
\]

\end_inset

The Fourier transform of the Gaussian function is well known and given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\hat{\psi}_{h}(\xi) & = & \intop_{-\infty}^{\infty}\frac{1}{\sqrt{4\pi}}e^{-\left(\frac{x}{2h}\right)^{2}}e^{-2\pi ix\xi}dx\\
 & = & \frac{1}{\sqrt{4\pi}}\intop_{-\infty}^{\infty}e^{-\left(\left(\frac{x}{2h}\right)^{2}+2\pi ix\xi+(2h\pi i\xi)^{2}-(2h\pi i\xi)^{2}\right)}dx\\
 & = & \frac{1}{\sqrt{4\pi}}e^{-(2h\pi\xi)^{2}}\intop_{-\infty}^{\infty}e^{-\left(\frac{x}{2h}+2h\pi i\xi\right)^{2}}dx\\
 & = & \frac{1}{\sqrt{4\pi}}e^{-(2h\pi\xi)^{2}}\intop_{-\infty}^{\infty}e^{-\left(\frac{x}{2h}\right)^{2}}dx\\
 & = & he^{-(2h\pi\xi)^{2}}
\end{eqnarray*}

\end_inset

where we used that 
\begin_inset Formula $\intop_{-\infty}^{\infty}e^{-\left(\frac{x}{2h}\right)^{2}}dx=h\,\sqrt{4\pi}$
\end_inset

 and completed squares in the exponential term.
 For the Gaussian function including a shift 
\begin_inset Formula $\psi_{h}(x+hm)$
\end_inset

, we get
\begin_inset Formula 
\begin{eqnarray*}
\hat{\psi}_{h}(\xi) & = & \intop_{-\infty}^{\infty}\frac{1}{\sqrt{4\pi}}e^{-\left(\frac{x+hm}{2h}\right)^{2}}e^{-2\pi ix\xi}dx\\
 & = & he^{-(2h\pi\xi)^{2}}e^{i2\pi\xi(hm)}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
For the case 
\begin_inset Formula $\xi=\frac{1}{2\pi}$
\end_inset

, we get
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\psi}_{h}\left(\frac{1}{2\pi}\right)=h\,e^{-h^{2}}
\]

\end_inset

or including the translation in the Gaussian we get
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\psi}_{h}\left(\frac{1}{2\pi}\right)=h\,e^{-h^{2}}e^{ihm}.
\]

\end_inset

Finally, one can obtain the equation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
b_{m}=h\,e^{-imh}\frac{1}{h\,e^{-h^{2}}}=e^{-imh}e^{h^{2}}
\]

\end_inset

to compute the coefficients 
\begin_inset Formula $b_{m}$
\end_inset

 for 
\begin_inset Formula $f(x)=e^{ix}$
\end_inset

.
\end_layout

\begin_layout Subsection
Step B: Approximation of basis function
\end_layout

\begin_layout Standard
The second step is the approximation of the basis function 
\begin_inset Formula $\psi_{h}(x)$
\end_inset

 itself with a rational approximation, see 
\begin_inset CommandInset citation
LatexCommand cite
key "Damle:Near optimal rational approximations of large data sets"
literal "true"

\end_inset

.
 Our basis function is given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\psi_{h}(x):=(4\pi)^{-\frac{1}{2}}e^{-x^{2}/(4h^{2})}
\]

\end_inset

and a close-to-optimal approximation of 
\begin_inset Formula $\psi_{1}(x)$
\end_inset

 with a sum of rational functions is given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\psi_{1}(x)\approx Re\left(\sum_{l=-K}^{K}\frac{a_{l}}{ix+(\mu+i\,l)}\right)
\]

\end_inset

with the 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $a_{l}$
\end_inset

 given in 
\begin_inset CommandInset citation
LatexCommand cite
key "Damle:Near optimal rational approximations of large data sets"
literal "true"

\end_inset

, Table 1.
 We can generalise this approximation to arbitrary chosen 
\begin_inset Formula $h$
\end_inset

 via 
\begin_inset Formula 
\[
\psi_{h}(x)\approx Re\left(\sum_{l=-K}^{K}\frac{a_{l}}{i\frac{x}{h}+(\mu+i\,l)}\right).
\]

\end_inset

The theory of how these coefficients are calculated are in 
\begin_inset CommandInset citation
LatexCommand cite
key "Damle:Near optimal rational approximations of large data sets"
literal "true"

\end_inset

 and will not be described here.
 Therefore, we assume that the coefficients 
\begin_inset Formula $a_{l}$
\end_inset

 are given.
\end_layout

\begin_layout Subsection
Step C: Approximation of the approximation
\end_layout

\begin_layout Standard
We then combine the approximation (B) into the approximation (A), yielding
 the approximation 
\begin_inset Formula $\tilde{f}$
\end_inset

 for 
\begin_inset Formula $f$
\end_inset

 given by 
\begin_inset Formula 
\[
\tilde{f}(x)=\sum_{m=-M}^{M}b_{m}\psi_{h}(x+mh)=\sum_{m=-M}^{M}b_{m}Re\left(\sum_{l=-K}^{K}\frac{a_{l}}{i\frac{x+mh}{h}+(\mu+i\,l)}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\sum_{m=-M}^{M}b_{m}\sum_{k=-K}^{K}Re\left(\frac{ha_{l}}{ix+h(\mu+i(m+k))}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
We further like to simplify this equation and we observe, that for 
\begin_inset Formula $n:=m+k$
\end_inset

, the denominator is equal.
 We can hence express parts of the denomiator 
\begin_inset Formula $ix+h(\mu+i(m+k))$
\end_inset

 in terms of 
\begin_inset Formula $n:=m+k$
\end_inset

 by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\alpha_{n}:=h(\mu+i(m+k))=h(\mu+in)).\label{eq:alpha}
\end{equation}

\end_inset

Now, we merge the 
\begin_inset Formula $b_{m}$
\end_inset

 and 
\begin_inset Formula $a_{l}$
\end_inset

 coefficients and first have a look at the 
\begin_inset Formula $b_{m}$
\end_inset

 which is complex valued.
 We observe the following property: Assuming that we want to compute the
 real value of 
\begin_inset Formula $f(x)$
\end_inset

, only the real value of 
\begin_inset Formula $b_{m}$
\end_inset

 has to be merged with the sum, since the imaginary component would be dropped
 afterwards.
 This allows us to move the 
\begin_inset Formula $Re(b_{m})$
\end_inset

 values inside the 
\begin_inset Formula $\sum_{K}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Re(f(x)):=Re\left(\sum_{m=-M}^{M}\,\,\sum_{k=-K}^{K}\frac{Re(b_{m})\,ha_{l}}{ix+h(\mu+i(m+k))}\right).
\]

\end_inset

Now we can collect all nominators with equivalent denominator (if 
\begin_inset Formula $n=m+k$
\end_inset

 and by using 
\begin_inset Formula $\delta$
\end_inset

 as the Kronecker delta), yielding
\end_layout

\begin_layout Standard
	
\begin_inset Formula 
\begin{equation}
\beta_{n}^{Re}:=h\sum_{m=-M\,}^{M}\sum_{k=-K}^{K}Re(b_{m})a_{k}\delta(n,\,m+k)\label{eq:beta_re}
\end{equation}

\end_inset

for real values 
\begin_inset Formula $f(x)$
\end_inset

 and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\beta_{n}^{Im}:=h\sum_{m=-M\,}^{M}\sum_{k=-K}^{K}Im(b_{m})a_{k}\delta(n,\,m+k)\label{eq:beta_im}
\end{equation}

\end_inset

for complex values of 
\begin_inset Formula $f(x)$
\end_inset

.
 Note, that the complexity of this operation is 
\begin_inset Formula $O(N\,K)$
\end_inset

, which is negligible for small 
\begin_inset Formula $N$
\end_inset

 and 
\begin_inset Formula $K$
\end_inset

.
 This can be optimized by using 
\begin_inset Formula $L_{1}=max(-K,n-M)$
\end_inset

 and 
\begin_inset Formula $L_{2}=min(K,n+M)$
\end_inset

 (see 
\begin_inset CommandInset citation
LatexCommand cite
key "Terry:High-order time-parallel approximation of evolution operators"
literal "true"

\end_inset

) and we can compute 
\begin_inset Formula $\beta_{n}^{Re}$
\end_inset

 with
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\beta_{n}^{Re}:=h\sum_{k=L_{1}}^{L_{2}}Re(b_{n-k})a_{k},\label{eq:beta_re_fast}
\end{equation}

\end_inset

and 
\begin_inset Formula $\beta_{n}^{Im}$
\end_inset

 correspondingly.
\end_layout

\begin_layout Standard
Finally, we get the REXI approximation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
e^{ix}\approx\sum_{n=-N}^{N}Re\left(\frac{\beta_{n}^{Re}}{ix+\alpha_{n}}\right)+i\,Re\left(\frac{\beta_{n}^{Im}}{ix+\alpha_{n}}\right).
\]

\end_inset


\end_layout

\begin_layout Subsection
Merging real and imaginary exp-approximation
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:merging_real_and_imag"

\end_inset

With the previous formulation, we would have to extract the real components
 from the complex values.
 However, this is not applicable if we use this for a linear operator.
 Therefore we require the system to cancel out the imaginary parts.
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{eqnarray*}
e^{ix} & \approx & \sum_{n=-N}^{N}Re\left(\frac{\beta_{n}^{Re}}{ix+\alpha_{n}}\right)+i\,Re\left(\frac{\beta_{n}^{Im}}{ix+\alpha_{n}}\right)\\
 & = & \frac{1}{2}\sum_{n=-N}^{N}\left(\frac{\beta_{n}^{Re}}{ix+\alpha_{n}}\right)+\overline{\left(\frac{\beta_{n}^{Re}}{ix+\alpha_{n}}\right)}+i\,\left(\left(\frac{\beta_{n}^{Im}}{ix+\alpha_{n}}\right)+\overline{\left(\frac{\beta_{n}^{Im}}{ix+\alpha_{n}}\right)}\right)\\
 & = & \frac{1}{2}\sum_{n=-N}^{N}\left(\frac{\beta_{n}^{Re}+i\beta_{n}^{Im}}{ix+\alpha_{n}}\right)+\overline{\left(\frac{\beta_{n}^{Re}-i\beta_{n}^{Im}}{ix+\alpha_{n}}\right)}\\
 & = & \frac{1}{2}\sum_{n=-N}^{N}\left(\frac{\beta_{n}^{Re}+i\beta_{n}^{Im}}{ix+\alpha_{n}}\right)+\left(\frac{\overline{\beta_{n}^{Re}-i\beta_{n}^{Im}}}{\overline{ix+\alpha_{n}}}\right)\\
 & = & \frac{1}{2}\sum_{n=-N}^{N}\left(\frac{\beta_{n}^{Re}+i\beta_{n}^{Im}}{ix+\alpha_{n}}\right)+\left(\frac{\overline{\beta_{n}^{Re}-i\beta_{n}^{Im}}}{-ix+\overline{\alpha_{n}}}\right)\\
 & = & \frac{1}{2}\sum_{n=-N}^{N}\left(\frac{\beta_{n}^{Re}+i\beta_{n}^{Im}}{ix+\alpha_{n}}\right)+\left(\frac{\overline{-\beta_{-n}^{Re}+i\beta_{-n}^{Im}}}{ix-\alpha_{n}}\right)\\
 & = & \frac{1}{2}\sum_{n=-N}^{N}\left(\frac{\beta_{n}^{Re}+i\beta_{n}^{Im}}{ix+\alpha_{n}}\right)+\left(\frac{\overline{-\beta_{-n}^{Re}}+\overline{i\beta_{-n}^{Im}}}{ix-\alpha_{n}}\right)\\
 & = & \frac{1}{2}\sum_{n=-N}^{N}\left(\frac{\beta_{n}^{Re}+i\beta_{n}^{Im}}{ix+\alpha_{n}}\right)-\left(\frac{\overline{\beta_{-n}^{Re}}+i\overline{\beta_{-n}^{Im}}}{ix-\alpha_{n}}\right)\\
 & = & \frac{1}{2}\sum_{n=-N}^{N}\left(\frac{\beta_{n}^{Re}+i\beta_{n}^{Im}}{ix+\alpha_{n}}\right)-\left(\frac{\beta_{n}^{Re}-i\beta_{n}^{Im}}{ix-\alpha_{n}}\right)
\end{eqnarray*}

\end_inset

Where we used 
\begin_inset Formula $\beta_{n}^{Re}=\overline{\beta_{-n}^{Re}}$
\end_inset

 and 
\begin_inset Formula $\beta_{n}^{Im}=-\overline{\beta_{-n}^{Im}}$
\end_inset

.
 Finally, we gain new 
\begin_inset Formula $\beta$
\end_inset

 and 
\begin_inset Formula $\alpha$
\end_inset

 coefficients which don't require application of the 
\begin_inset Formula $Re()$
\end_inset

 operator.
 However, one drawback is that the number of coefficients is enlarged by
 a factor of two.
\end_layout

\begin_layout Subsection
Example coefficients
\end_layout

\begin_layout Standard
For a better understanding and discussion of the poles, we provide some
 explanatory coefficients for 
\begin_inset Formula $\alpha_{n}$
\end_inset

 and 
\begin_inset Formula $\beta_{n}^{Re}$
\end_inset

 computed with 
\begin_inset Formula $M:=2$
\end_inset

 and 
\begin_inset Formula $h:=0.2$
\end_inset

:
\end_layout

\begin_layout Standard

\size scriptsize
\begin_inset Tabular
<lyxtabular version="3" rows="28" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\alpha_{n}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\beta_{n}^{Re}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-13
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -2.6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-2.0794560075645e-08,5.312368394177e-09)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -2.4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-1.8562925598646e-08,-1.6892470811809e-07)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -2.2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(6.8570271350932e-07,-4.4377515257134e-08)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(1.9470768200785e-07,2.1186231739561e-06)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -1.8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(3.037169144916e-06,-3.8007524015554e-06)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -1.6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.00020292956274934,-9.4793805592883e-05)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -1.4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(0.00051562027155282,0.0033198141762956)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -1.2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(0.023802856324805,-0.020097812439831)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.16210306892042,-0.057527918763957)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -0.8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(0.083936569694558,0.55379453117192)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -0.6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(0.87683903065806,-0.58136186212318)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -0.4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.87618099667542,-0.6444132979014)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, -0.2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.2112750856805,0.51693268636776)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
(-0.863064302175, 0)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
(0.21113064943379,1.1012434042446e-07)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 0.2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.2112752777559,-0.51693263772868)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 0.4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.87618105783081,0.6444131761443)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 0.6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(0.87683907406497,0.58136183517238)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 0.8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(0.083936534477108,-0.55379454106338)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.16210304313401,0.057527824955638)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 1.2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(0.023802980792584,0.020097827969804)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 1.4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(0.00051562077173168,-0.0033196934926057)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 1.6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.0002030221163996,9.4802957184526e-05)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 1.8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(3.0281700967037e-06,3.7434363774526e-06)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(2.2311216999616e-07,-2.1234907990132e-06)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 2.2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(6.871098037128e-07,5.5123982746463e-08)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 2.4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-2.1322288893395e-08,1.6899352278552e-07)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
13
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-0.863064302175, 2.6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
(-2.0738399377275e-08,-5.6642992624128e-09)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Merges alpha and beta coefficients have similar properties.
\end_layout

\begin_layout Section
REXI on linear operators
\end_layout

\begin_layout Standard
In this section, we investigate the linear operator 
\begin_inset Formula $L$
\end_inset

 with the rational approximation.
\end_layout

\begin_layout Subsection
Cancellation of imaginary values
\end_layout

\begin_layout Standard
For sake of simplicity, we only consider the first or second half of the
 merged 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

 from the previous section! In particular, with 
\begin_inset Formula $Im(\alpha_{0})=Im(\beta_{0})=0$
\end_inset

, there is a zero imaginary number for the central pole.
 Then, there is an anti-symmetry around the central pole with
\begin_inset Formula 
\begin{equation}
\alpha_{-n}=\overline{\alpha_{n}}\label{eq:alpha_conjugate_symmetry}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\beta_{-n}=\overline{\beta_{n}}.\label{eq:beta_conjugate_symmetry}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We start with REXI given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
e^{\tau L} & \approx & \sum_{n=-N}^{N}\beta_{n}(\tau L+\alpha_{n})^{-1}\\
 & = & \sum_{n=-N}^{-1}\beta_{n}(\tau L+\alpha_{n})^{-1}+\beta_{0}(\tau L+\alpha_{0})^{-1}+\sum_{n=-N}^{-1}\beta_{-n}(\tau L+\alpha_{-n})^{-1}
\end{eqnarray*}

\end_inset

and using the properties 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:alpha_conjugate_symmetry"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta_conjugate_symmetry"

\end_inset

, we can write this as
\begin_inset Formula 
\begin{eqnarray*}
 &  & \sum_{n=-N}^{-1}\beta_{n}\left(\tau L+\alpha_{n}\right)^{-1}+\beta_{0}(\tau L+\alpha_{0})^{-1}+\sum_{n=-N}^{-1}\overline{\beta_{n}}(\tau L+\overline{\alpha_{n}})^{-1}\\
 & = & \sum_{n=-N}^{-1}\beta_{n}\left(\tau L+\alpha_{n}\right)^{-1}+\beta_{0}(\tau L+\alpha_{0})^{-1}+\sum_{n=-N}^{-1}\overline{\beta_{n}(\tau L+\alpha_{n})^{-1}}.
\end{eqnarray*}

\end_inset

which shows that the imaginary parts cancel out.
\end_layout

\begin_layout Standard
This is also shows (see Sec.
 3.3 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Terry:High-order time-parallel approximation of evolution operators"
literal "true"

\end_inset

)
\begin_inset Formula 
\[
\overline{(L+\alpha)^{-1}U(0)}=(L+\overline{\alpha})^{-1}U(0).
\]

\end_inset


\end_layout

\begin_layout Subsection
Reducing number of computations for 
\begin_inset Formula $L$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:reducing_number_of_computations"

\end_inset

For 
\begin_inset Formula $L$
\end_inset

 and 
\begin_inset Formula $U(0)$
\end_inset

 real-valued only and with the overbar denoting the complex conjugate.
 We can then reformulate the approximation
\begin_inset Formula 
\begin{eqnarray*}
e^{\tau L} & \approx & \sum_{n=-N}^{-1}\beta_{n}\left(\tau L+\alpha_{n}\right)^{-1}+\beta_{0}\left(\tau L+\alpha_{0}\right)^{-1}+\sum_{n=-N}^{-1}\beta_{-n}\left(\tau L+\alpha_{-n}\right)^{-1}\\
 & = & \sum_{n=-N}^{-1}\beta_{n}\left(\tau L+\alpha_{n}\right)^{-1}+\beta_{0}\left(\tau L+\alpha_{0}\right)^{-1}+\sum_{n=-N}^{-1}\overline{\beta_{N-1-n}}\left(\tau L+\overline{\alpha_{N-1-n}}\right)^{-1}
\end{eqnarray*}

\end_inset

and using the properties 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:alpha_conjugate_symmetry"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta_conjugate_symmetry"

\end_inset

, we can write this as
\begin_inset Formula 
\begin{eqnarray*}
 &  & \sum_{n=-N}^{-1}\beta_{n}\left(\tau L+\alpha_{n}\right)^{-1}+\beta_{0}\left(\tau L+\alpha_{0}\right)^{-1}+\sum_{n=-N}^{-1}\overline{\beta_{N-1-n}}\left(\tau L+\overline{\alpha_{N-1-n}}\right)^{-1}\\
 & = & \sum_{n=-N}^{-1}\beta_{n}\left(\tau L+\alpha_{n}\right)^{-1}+\beta_{0}\left(\tau L+\alpha_{0}\right)^{-1}+\sum_{n=-N}^{-1}\beta_{n}\left(\tau L+\alpha_{n}\right)^{-1}
\end{eqnarray*}

\end_inset

which shows that the imaginary parts cancel out.
\end_layout

\begin_layout Standard
Since the imaginary parts cancel out for 
\begin_inset Formula $Re(a+\overline{a})=a+\overline{a}$
\end_inset

 and with 
\begin_inset Formula $\alpha_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{0}$
\end_inset

 being only real-valued, we can simplify the equation to
\begin_inset Formula 
\[
e^{\tau L}\approx\sum_{n=-N}^{N}\left(\tau L+\alpha_{n}\right)^{-1}=\sum_{n=-N}^{-1}\left(\frac{2\beta_{n}}{\tau L+\alpha_{n}}\right)+\frac{\beta_{0}}{\tau L+\alpha_{0}}.
\]

\end_inset

This allows us to reduce the computational amount almost by a factor of
 two for solving 
\begin_inset Formula $(L+\alpha)^{-1}$
\end_inset

 giving the real valued solution
\begin_inset Formula 
\[
U(\tau)=e^{\tau L}U(0)\approx\sum_{n=0}^{N}\gamma_{n}\left(\tau L+\alpha_{n}\right)^{-1}U(0)
\]

\end_inset

with 
\begin_inset Formula 
\[
\gamma_{n}:=\begin{cases}
\begin{array}{c}
\beta_{0}\\
2\beta_{n}
\end{array} & \begin{array}{c}
for\,n=0\\
else
\end{array}\end{cases}
\]

\end_inset


\end_layout

\begin_layout Subsection
Matrix exponential
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:mat_exp"

\end_inset

 We would like to apply REXI to a formulation such as 
\begin_inset Formula 
\[
U(t)=e^{\tau L}U(0).
\]

\end_inset

To see the relationship between the approximation of 
\begin_inset Formula $e^{ix}$
\end_inset

 with 
\begin_inset Formula $e^{\tau L}$
\end_inset

 we assume that 
\begin_inset Formula $L$
\end_inset

 is skew hermitian and therefore has only purely imaginary eigenvalues,
 and maybe decomposed as 
\begin_inset Formula $\Sigma\Lambda\Sigma^{H}$
\end_inset

, yielding 
\begin_inset Formula 
\begin{equation}
e^{\tau L}=\sum_{k=0}^{\infty}\frac{(\tau L)^{k}}{k!}=\sum_{k=0}^{\infty}\frac{\tau\Sigma\Lambda^{k}\Sigma^{H}}{k!}=\Sigma\left(\sum_{k=0}^{\infty}\frac{(\tau\Lambda)^{k}}{k!}\right)\Sigma^{H}=\Sigma e^{\tau\Lambda}\Sigma^{H},\label{eq:expL}
\end{equation}

\end_inset

where we used the orthonormality of 
\begin_inset Formula $\Sigma$
\end_inset

 to cancel it out from the summation, and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
e^{\tau\Lambda}=\left(\begin{array}{ccc}
...\\
 & e^{i\lambda_{j}\tau}\\
 &  & ...
\end{array}\right)
\]

\end_inset

where we have explicitly detached the imaginary unit from the eigenvalues,
 therefore 
\begin_inset Formula $\lambda_{n}$
\end_inset

 are assumed real.
 Since 
\begin_inset Formula $e^{\tau\Lambda}$
\end_inset

 is diagonal, it can be eigenvalue-wise approximated in the same way as
 in 
\begin_inset Formula $e^{ix}$
\end_inset

 with REXI.
\end_layout

\begin_layout Standard
Although 
\begin_inset Formula $L$
\end_inset

 has imaginary eigenvalues, we wish to evaluate the 
\begin_inset Formula $e^{\tau L}U(0)$
\end_inset

, which is real valued.
 Therefore, we will use the real approximation of 
\begin_inset Formula $e^{ix}$
\end_inset

 
\begin_inset Formula 
\begin{equation}
exp(\tau L)\approx Re\left(\sum_{n=-N}^{N}\beta_{n}(\tau L+\alpha_{n})^{-1}\right),\label{eq:rexi}
\end{equation}

\end_inset

where 
\begin_inset Formula $\beta_{n}$
\end_inset

 is given by equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta_re"

\end_inset

 and 
\begin_inset Formula $\alpha_{n}$
\end_inset

 by equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:alpha"

\end_inset

.
\end_layout

\begin_layout Standard
Given the linear operator 
\begin_inset Formula $L$
\end_inset

 to be applied on 
\begin_inset Formula $U(0)$
\end_inset

, we continue to show the relation of the linear operator to the REXI approximat
ion of the real term
\begin_inset Formula 
\[
e^{\tau L}\approx\sum_{n=-N}^{N}Re\left(\frac{\beta_{n}^{Re}}{\tau L+\alpha_{n}}\right)
\]

\end_inset

as we use it later on.
 Next, we rewrite 
\begin_inset Formula $L$
\end_inset

 with our EV decomposition as
\begin_inset Formula 
\begin{eqnarray*}
e^{\tau L} & \approx & \sum_{n=-N}^{N}Re\left(\beta_{n}^{Re}(\tau\Sigma\Lambda\Sigma^{-1}+\alpha_{n}I)^{-1}\right)\\
 & = & \sum_{n=-N}^{N}Re\left(\beta_{n}^{Re}(\Sigma(\tau\Lambda\Sigma^{-1}+\alpha_{n}\Sigma^{-1}))^{-1}\right)\\
 & = & \sum_{n=-N}^{N}Re\left(\beta_{n}^{Re}(\Sigma^{-1}(\tau\Lambda+\alpha_{n}\Sigma^{-1}\Sigma)){}^{-1}\Sigma^{-1}\right)\\
 & = & \sum_{n=-N}^{N}Re\left(\beta_{n}^{Re}\Sigma(\tau\Lambda+\alpha_{n})^{-1}\Sigma^{-1}\right)\\
 & = & \approx\Sigma e^{\tau\Lambda}\Sigma^{H}
\end{eqnarray*}

\end_inset

Note, that we use the same REXI approximation for different 
\begin_inset Formula $\lambda_{j}$
\end_inset

.
 Hence, the approximation has to be sufficiently accurate over the entire
 range of all Eigenvalues
\begin_inset Formula $\lambda_{j}$
\end_inset

 which is what we use the approximation for.
\end_layout

\begin_layout Subsection
Choosing 
\begin_inset Formula $h$
\end_inset

 and 
\begin_inset Formula $M$
\end_inset


\end_layout

\begin_layout Standard
Some important points about the choice of 
\begin_inset Formula $M$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

 have to be made at this point.
 We know that 
\begin_inset Formula $e^{ix}$
\end_inset

 is accurately approximated with REXI for the interval 
\begin_inset Formula $|x|<hM$
\end_inset

, where 
\begin_inset Formula $h$
\end_inset

 is chosen small enough to obtain a good approximation in step (A), and
 
\begin_inset Formula $M$
\end_inset

 will define the interval size and number of approximation points.
 In the matrix case, 
\begin_inset Formula $M$
\end_inset

 has to be chosen so that 
\begin_inset Formula $hM>t\bar{\lambda}$
\end_inset

, where 
\begin_inset Formula $\bar{\lambda}=\max_{n}|\lambda_{n}|$
\end_inset

, in order to capture all wavelengths of 
\begin_inset Formula $L$
\end_inset

.
 In other other words, 
\begin_inset Formula $hM$
\end_inset

 need to be set to capture the fastest wave.
 Note that if this is used as a time stepping method, with time step 
\begin_inset Formula $t=\tau$
\end_inset

, then, the larger the timestep, the larger 
\begin_inset Formula $M$
\end_inset

 will be.
 Exact evaluations of the choices for 
\begin_inset Formula $h$
\end_inset

 and 
\begin_inset Formula $M$
\end_inset

 may be done based on equation (3.6) of 
\begin_inset CommandInset citation
LatexCommand cite
key "Terry:High-order time-parallel approximation of evolution operators"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Handling 
\begin_inset Formula $\tau$
\end_inset

 in REXI
\begin_inset CommandInset label
LatexCommand label
name "subsec:Handling-tau-in-REXI"

\end_inset


\end_layout

\begin_layout Standard
We reformulate the REXI approximation scheme given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
(\tau L+\alpha)U(\tau)=U(0)
\]

\end_inset

and by factoring 
\begin_inset Formula $\tau$
\end_inset

 out, yielding
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
(L+\frac{\alpha}{\tau})U(\tau)=\tau^{-1}U(0)
\]

\end_inset

So instead of solving for 
\begin_inset Formula $U(\tau)$
\end_inset

, we are solving for 
\begin_inset Formula $U^{\tau}(0):=U(0)\tau^{-1}$
\end_inset

 as well as 
\begin_inset Formula $\alpha^{\tau}:=\frac{\alpha}{\tau}$
\end_inset

.
\end_layout

\begin_layout Standard
To summarize, we have to solve the system of equations given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
(L+\alpha^{\tau})U(\tau)=\tau^{-1}U(0)\label{eq:unit_rexi_timestep}
\end{equation}

\end_inset

with 
\begin_inset Formula $U(0)$
\end_inset

 the initial conditions.
 For sake of simplicity, we stick to the formulation without the 
\begin_inset Formula $\tau$
\end_inset

 notation.
\end_layout

\begin_layout Subsection
Computing inverse of 
\begin_inset Formula $(L+\alpha)^{-1}$
\end_inset


\end_layout

\begin_layout Standard
For computing the inverse, arbitrary solvers can be used.
 However we like to note, that 
\begin_inset Formula $\alpha$
\end_inset

 is a complex number.
 Hence, requiring solvers with support for solving in complex space.
\end_layout

\begin_layout Standard
We wish to solve the differential problem for each time step 
\begin_inset Formula 
\[
(L+\alpha)U=U(0)
\]

\end_inset

so that 
\begin_inset Formula $U=(L+\alpha)^{-1}U_{0}$
\end_inset

.
 Note, the change in sign before 
\begin_inset Formula $L$
\end_inset

 for convenience which has to be accounted for afterwards.
 We will do this converting the problem into and elliptic equation.
\series bold

\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
First, lets expand the equations with the definition of 
\begin_inset Formula $L$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray}
fv-g\eta_{x}+\alpha u & = & u_{0},\label{eq:mom_u}\\
-fu-g\eta_{y}+\alpha v & = & v_{0},\label{eq:mom_v}\\
-\bar{\eta}(u_{x}+v_{y})+\alpha\eta & = & \eta_{0}.\label{eq:mass}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $f$
\end_inset

 be constant (f-plane approximation), 
\begin_inset Formula $\delta:=u_{x}+v_{y}$
\end_inset

 be the wind divergence, 
\begin_inset Formula $\zeta:=v_{x}-u_{y}$
\end_inset

 be the wind (relative) vorticity and 
\begin_inset Formula $\Delta\eta:=\eta_{xx}+\eta_{yy}$
\end_inset

 the Laplacian of the fluid depth.
 We will re-write the problem in a divergence-vorticity formulation by taking
 2 steps.
 First, sum the 
\begin_inset Formula $\partial_{x}$
\end_inset

 of equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mom_u"

\end_inset

 and the 
\begin_inset Formula $\partial_{y}$
\end_inset

 of equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mom_v"

\end_inset

, yielding 
\begin_inset Formula 
\begin{equation}
f\zeta-g\Delta\eta+\alpha\delta=\delta_{0}.\label{eq:zeta}
\end{equation}

\end_inset

Then subtract the 
\begin_inset Formula $\partial_{y}$
\end_inset

 of equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mom_u"

\end_inset

 from the 
\begin_inset Formula $\partial_{x}$
\end_inset

 of equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mom_v"

\end_inset

, yielding 
\begin_inset Formula 
\begin{equation}
-f\delta+\alpha\zeta=\zeta_{0}.\label{eq:delta}
\end{equation}

\end_inset

Using equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:zeta"

\end_inset

 in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:delta"

\end_inset

 gives us
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta=\frac{1}{f^{2}+\alpha^{2}}\left(\alpha g\Delta\eta+\alpha\delta_{0}-f\zeta_{0}\right).
\]

\end_inset

Finally, substituting 
\begin_inset Formula $\delta$
\end_inset

 in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass"

\end_inset

, that reads 
\begin_inset Formula $\bar{\eta}\delta+\alpha\eta=\eta_{0}$
\end_inset

, results in 
\begin_inset Formula 
\[
-\frac{\bar{\eta}}{f^{2}+\alpha^{2}}\left(\alpha g\Delta\eta+\alpha\delta_{0}-f\zeta_{0}\right)+\alpha\eta=\eta_{0},
\]

\end_inset

which can be written as an eliptic equation with
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
(\kappa-\overline{\eta}g\Delta)\eta=r_{0}\label{eq:ellip}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\[
\kappa=f^{2}+\alpha^{2}
\]

\end_inset

and 
\begin_inset Formula 
\[
r_{0}=\frac{\kappa}{\alpha}\eta_{0}-\overline{\eta}\frac{f}{\alpha}\zeta_{0}+\overline{\eta}\delta_{0}.
\]

\end_inset


\end_layout

\begin_layout Standard
We can compute
\begin_inset Formula $\eta$
\end_inset

 with a solver for elliptic problems.
 Special attention has to be given to the LHS of the form 
\begin_inset Formula $(\gamma-\Delta)\eta$
\end_inset

 for a spectral solver and this is the reason for this brief excursion.
 We use 
\begin_inset Formula $\tilde{}$
\end_inset

 to annotate an operator or quantity to be given in spectral space.
 Then, we factor 
\begin_inset Formula $\tilde{\eta}$
\end_inset

 in and write form of the LHS in spectral space with the identity matrix
 
\begin_inset Formula $I$
\end_inset

 as
\begin_inset Formula 
\[
(\gamma I\tilde{\eta}-\tilde{\Delta}\tilde{\eta})=(\gamma I-\tilde{\Delta})\tilde{\eta}
\]

\end_inset

Here, the minus operator in spectral space has to be applied on all elements
 of 
\begin_inset Formula $\tilde{\Delta}$
\end_inset

 and not only to the 
\begin_inset Formula $0^{th}$
\end_inset

 mode as it is typically the case for adding a constant in spectral space.
\end_layout

\begin_layout Standard
We need to retrieve the velocities by solving the 
\begin_inset Formula $2\times2$
\end_inset

 system formed by equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mom_u"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mom_v"

\end_inset

, which reads 
\begin_inset Formula 
\[
A_{\alpha}U=U_{0}+g\nabla\eta
\]

\end_inset

with 
\begin_inset Formula 
\[
A_{\alpha}=\left(\begin{matrix}\alpha & f\\
-f & \alpha
\end{matrix}\right).
\]

\end_inset

The solution is 
\begin_inset Formula 
\[
U=A_{\alpha}^{-1}(U_{0}+g\nabla\eta)
\]

\end_inset

where 
\begin_inset Formula 
\[
A_{\alpha}^{-1}=\frac{1}{f^{2}+\alpha^{2}}\left(\begin{matrix}\alpha & -f\\
f & \alpha
\end{matrix}\right)
\]

\end_inset


\end_layout

\begin_layout Subsection
Interpretation of 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\begin_layout Standard
We like to close this section with a brief discussion of 
\begin_inset Formula $\tau$
\end_inset

 by having a look on the REXI reformulation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left(L+\frac{\alpha}{\tau}\right)^{-1}U\tau^{-1}=U_{0}
\]

\end_inset

We see, that for an increasing 
\begin_inset Formula $\tau$
\end_inset

, hence an integration in time over a larger time period, the poles given
 by 
\begin_inset Formula $\alpha$
\end_inset

 are getting closer.
 This can possibly lead to a loss in accuracy for the data sampled by the
 outer poles 
\begin_inset Formula $\alpha_{-N}$
\end_inset

 and 
\begin_inset Formula $\alpha_{N}$
\end_inset

.
 Therefore, the number 
\begin_inset Formula $N$
\end_inset

 of poles is expected to scale linearly with the size of the coarse time
 step, 
\begin_inset Formula 
\[
|N|\propto\tau.
\]

\end_inset


\end_layout

\begin_layout Standard
Indeed, we saw in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:mat_exp"

\end_inset

 that for larger 
\begin_inset Formula $\tau$
\end_inset

, 
\begin_inset Formula $M$
\end_inset

 needs to be larger.
\end_layout

\begin_layout Subsection
Errors and fault tolerance
\end_layout

\begin_layout Standard

\series bold
TODO: CHECK THIS, IT MIGHT BE WRONG
\end_layout

\begin_layout Standard
One question arising is what the error is in case that one term of the REXI
 approximation is not computed.
 We assume that this will depend on 
\begin_inset Formula $\alpha_{i}$
\end_inset

 and continue investigating this further
\end_layout

\begin_layout Standard
Directly analysing the errors with the formulation 
\begin_inset Formula $\left(L-\alpha\right)^{-1}U=U_{0}$
\end_inset

 seems to be relatively challenging and we therefore decide to start direclty
 with the Helmholtz formulation
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\[
((\alpha^{2}+f^{2})-g\bar{\eta}\Delta)\eta=\frac{f^{2}+\alpha^{2}}{\alpha}\eta_{0}-\bar{\eta}\delta_{0}-\frac{f\bar{\eta}}{\alpha}\zeta_{0}
\]

\end_inset

and use the spectral space with selected frequencies 
\begin_inset Formula $\eta=exp(ikx)$
\end_inset

 for all quantities
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
.
\end_layout

\begin_layout Standard
Using the spectral representation leads to
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\[
((\alpha^{2}+f^{2})+g\bar{\eta}k^{2})\hat{\eta}=\frac{f^{2}+\alpha^{2}}{\alpha}\hat{\eta}_{0}-\bar{\eta ik}(\hat{u}+\hat{v})-\frac{f\bar{\eta}}{\alpha}ik(\hat{v}-\hat{u})
\]

\end_inset


\end_layout

\begin_layout Standard
Solving this for 
\begin_inset Formula $\hat{\eta}$
\end_inset

 yields
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\[
\hat{\eta}=\frac{\frac{f^{2}+\alpha^{2}}{\alpha}\hat{\eta}_{0}-\bar{\eta ik}(\hat{u}+\hat{v})-\frac{f\bar{\eta}}{\alpha}ik(\hat{v}-\hat{u})}{((\alpha^{2}+f^{2})+g\bar{\eta}k^{2})}
\]

\end_inset

Considering the tabulated alpha values, we observe a constant real alpha
 value and increasing imaginary parts for larger 
\begin_inset Formula $N$
\end_inset

.
 Hence, also the denominator increases and results in relatively small solutions
 
\begin_inset Formula $\hat{\eta}.$
\end_inset

 The same accounts for the explicit formulation to compute the velocities.
\end_layout

\begin_layout Standard
We tested this imperically with the code in helmholtz_problem_fault_tolerance.py.
\end_layout

\begin_layout Standard
Additionally, we can also observe significantly decreasing 
\begin_inset Formula $\beta_{i}$
\end_inset

 for increasing 
\begin_inset Formula $i$
\end_inset

.
\end_layout

\begin_layout Standard
To conclude, the amplitude (the real part) decreases significantly with
 increasing 
\begin_inset Formula $\alpha_{i}$
\end_inset

 values.
 
\series bold
TODO: CHECK THIS, IT MIGHT BE WRONG
\end_layout

\begin_layout Subsection
Numerical Dispersion
\end_layout

\begin_layout Standard
We continue to (try to) analyze possible dispersion effects of the REXI
 approximation.
 Here, we assume that we use an accurate solver to compute 
\begin_inset Formula $(L-\alpha_{i})^{-1}$
\end_inset

.
 We are interested in answering the question which error is introduced when
 not using enough terms in the approximation.
\end_layout

\begin_layout Standard
According to 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:mat_exp"

\end_inset

, we can decompose the linear operator into EVals and EVects and write the
 approximation in the following way:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
e^{\tau L}\approx\Sigma\left[\sum_{n=0}^{N}Re\left(\gamma_{n}(\tau\Lambda+\alpha_{n})^{-1}\right)\right]\Sigma^{H}.
\]

\end_inset

Alternatively without solving a linear operator, one can also think directly
 about approximating a set of exponents given by 
\begin_inset Formula $\Lambda$
\end_inset

 with
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
e^{\tau\Lambda}\approx\sum_{n=0}^{N}\left(\gamma_{n}(\tau\Lambda+\alpha_{n})^{-1}\right).
\]

\end_inset

We can then use the spectral representation of the solution
\begin_inset Formula 
\[
e^{\tau\hat{L}}=\hat{\Sigma}e^{\tau\hat{\Lambda}}\hat{\Sigma}^{H}
\]

\end_inset

with 
\begin_inset Formula $\hat{L}=\hat{\Sigma}\hat{\Lambda}$
\end_inset

the spectral EValue/EVector decomposition.
 We can then approximate the exponential 
\begin_inset Formula $e^{\tau\Lambda}$
\end_inset

 by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
e^{\tau\hat{L}}\approx\hat{\Sigma}\sum_{n=0}^{N}\left(\gamma_{n}(\tau\hat{\Lambda}+\alpha_{n})^{-1}\right)\hat{\Sigma}^{H}
\]

\end_inset

For selected modes 
\begin_inset Formula $(k_{1},k_{2})$
\end_inset

 at a specific point in time 
\begin_inset Formula $\tau=\sigma$
\end_inset

, the solution and operators in spectral space are then given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\hat{U}(k_{1},k_{2},\tau)= & e^{\tau\hat{L}_{k_{1},k_{2}}}\hat{U}(k_{1},k_{2},0)\\
\approx & \hat{\Sigma}_{k_{1},k_{2}}\left[\sum_{n=-N}^{N}Re\left(\beta_{n}^{Re}(\tau\hat{\Lambda}_{k_{1},k_{2}}+\alpha_{n})^{-1}\right)\right]\hat{\Sigma}_{k_{1},k_{2}}^{H}\hat{U}(k_{1},k_{2},0).
\end{align*}

\end_inset

Case A) For 
\begin_inset Formula $k_{1}\neq0$
\end_inset

 and 
\begin_inset Formula $k_{2}\neq0$
\end_inset

, we know that 
\begin_inset Formula $\hat{\Lambda}$
\end_inset

contains eigenvalues
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="right" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vortical mode:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\omega_{0}=0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Gravitational modes:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\omega_{\pm1}=\pm\sqrt{4\pi^{2}(\eta_{0}gk_{1}^{2}+\eta_{0}gk_{2}^{2})+f^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset

Case B) For 
\begin_inset Formula $k_{1}=k_{2}=0$
\end_inset

, we get the eigenvalues
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="right" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vortical mode:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\omega_{0}=0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Gravitational modes:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\omega_{\pm1}=\pm f$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset

These eigenvalues describe the frequency in 
\begin_inset Formula $\hat{\Lambda}$
\end_inset

 which we approximate.
 As soon as this frequency cannot be approximated anymore with REXI, this
 results in errors in the dispersion of this particular frequency.
\end_layout

\begin_layout Standard
With the computational requirements (M) of REXI being related to the fastest
 waves, we can identify the requirement 
\begin_inset Formula $M\sim\sqrt{\eta_{0}g}$
\end_inset

 and 
\begin_inset Formula $M\sim f$
\end_inset

.
\end_layout

\begin_layout Standard

\emph on
Vortical modes
\emph default
: Since the vortical modes are always zero, we do not expect any (analytical)
 errors in these modes.
 However, due to discretization, errors can accumulate and show up.
\end_layout

\begin_layout Standard

\emph on
Gravitational modes: 
\emph default
We can observe that errors in the frequency 
\begin_inset Formula $\omega_{\pm1}$
\end_inset

 in case A area generated.
 The dominating frequency is only dependent on 
\begin_inset Formula $\eta_{0}$
\end_inset

 and 
\begin_inset Formula $g$
\end_inset

 in case of
\begin_inset Formula 
\[
4\pi^{2}(\eta_{0}gk_{1}^{2}+\eta_{0}gk_{2}^{2})=4\pi^{2}\eta_{0}g|k|^{2}>f^{2}
\]

\end_inset

and 
\begin_inset Formula $f$
\end_inset

 otherwise.
 The factor 
\begin_inset Formula $4\pi^{2}$
\end_inset

 shows up since our domain is on 
\begin_inset Formula $\Omega=[0;1]^{2}$
\end_inset

.
 The Coriolis frequency 
\begin_inset Formula $f$
\end_inset

 is also independent of the spatial frequency, hence also the resolution.
\end_layout

\begin_layout Standard
Furthermore, we can observe a relation to the Rossby radius given by
\begin_inset Formula 
\[
L_{R}:=4\pi\text{²}\frac{\sqrt{g\eta_{0}}}{f}
\]

\end_inset

which describes at which scale at the Coriolis effect also strongly contributes
 to the simulation results compared to the gravitational and height values.
\end_layout

\begin_layout Subsection
Complex solver
\end_layout

\begin_layout Standard
We are interested in solving a system of the form, 
\begin_inset Formula 
\[
(-L+\alpha)U=U_{0},
\]

\end_inset

where 
\begin_inset Formula $\alpha$
\end_inset

 is a complex number, therefore we must allow complex solutions for 
\begin_inset Formula $U$
\end_inset

.
 The system can be transformed to have only real arithmetic in the following
 way.
\end_layout

\begin_layout Standard
First we decompose 
\begin_inset Formula $U$
\end_inset

 into its real and imaginary parts, 
\begin_inset Formula $U=U^{r}+iU^{i}$
\end_inset

, and allow 
\begin_inset Formula $U_{0}$
\end_inset

 to be decomposed in the same way.
 Although 
\begin_inset Formula $\alpha$
\end_inset

 can be a general complex number, it real part is always constant in REXI,
 given by 
\begin_inset Formula $\mu$
\end_inset

.
 We will therefore write 
\begin_inset Formula $\alpha=\mu+i\alpha^{i}$
\end_inset

, and we can absorb 
\begin_inset Formula $\mu$
\end_inset

 into 
\begin_inset Formula $L$
\end_inset

 writing 
\begin_inset Formula $D=-L+\mu I$
\end_inset

, where 
\begin_inset Formula $I$
\end_inset

 is the identity matrix.
 Now 
\begin_inset Formula 
\[
(D+i\alpha^{i}I)(U^{r}+iU^{i})=U_{0}^{r}+iU_{0}^{i},
\]

\end_inset


\begin_inset Formula 
\[
DU^{r}-\alpha^{i}U^{i}+i(\alpha^{i}U^{r}+DU^{i})=U_{0}^{r}+iU_{0}^{i},
\]

\end_inset

therefore 
\begin_inset Formula 
\begin{eqnarray}
DU^{r}-\alpha^{i}U^{i} & = & U_{0}^{r}\\
\alpha^{i}U^{r}+DU^{i} & = & U_{0}^{i},
\end{eqnarray}

\end_inset

which in matrix notation gives 
\begin_inset Formula 
\[
\left(\begin{matrix}D & -\alpha^{i}I\\
\alpha^{i}I & D
\end{matrix}\right)\left(\begin{matrix}U^{r}\\
U^{i}
\end{matrix}\right)=\left(\begin{matrix}U_{0}^{r}\\
U_{0}^{i}
\end{matrix}\right),
\]

\end_inset

or, 
\begin_inset Formula 
\[
\left(\begin{matrix}-L+\mu I & -\alpha^{i}I\\
\alpha^{i}I & -L+\mu I
\end{matrix}\right)\left(\begin{matrix}U^{r}\\
U^{i}
\end{matrix}\right)=\left(\begin{matrix}U_{0}^{r}\\
U_{0}^{i}
\end{matrix}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
A similar approach may be taken with the elliptic equation 
\begin_inset Formula 
\begin{equation}
\Delta\eta+\theta\eta=r_{0},
\end{equation}

\end_inset

where 
\begin_inset Formula $\eta$
\end_inset

, 
\begin_inset Formula $\theta$
\end_inset

 and 
\begin_inset Formula $r_{0}$
\end_inset

 may be complex.
 The resulting system is given by 
\begin_inset Formula 
\begin{eqnarray}
\Delta\eta^{r}+\theta^{r}\eta^{r}-\theta^{i}\eta^{i}=r_{0}^{r},\\
\Delta\eta^{i}+\theta^{i}\eta^{r}+\theta^{r}\eta^{i}=r_{0}^{i},
\end{eqnarray}

\end_inset

which can also be written in matrix notation and solved with arbitrary elliptic
 equation solvers.
\end_layout

\begin_layout Section
Compatibility table (merging + halving)
\end_layout

\begin_layout Standard
Different reformulations of the REXI coefficients for better approximation
 and reduced workload were suggested in the previous sections.
 Those were (a) the merging of real and imaginary approximation of 
\begin_inset Formula $\exp(ix)$
\end_inset

 (see Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:merging_real_and_imag"

\end_inset

) as well as halving the number of poles by exploiting symmetries and real-only
 valued linear operator (see Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:reducing_number_of_computations"

\end_inset

).
\end_layout

\begin_layout Standard
The test cases are described as follows:
\end_layout

\begin_layout Itemize
Approximation of real parts of complex-valued ODE:
\begin_inset Formula 
\[
Re(\exp(ix))u_{0}=Re\left(\sum_{n}\beta_{n}\left(ix+\alpha_{n}\right)^{-1}\right)u_{0}
\]

\end_inset


\end_layout

\begin_layout Itemize
Approximation of real and imaginary parts of complex-valued ODE
\begin_inset Formula 
\[
\exp(ix)u_{0}=\sum_{n}\beta_{n}\left(ix+\alpha_{n}\right)^{-1}u_{0}
\]

\end_inset


\end_layout

\begin_layout Itemize
Approximation of (real) linear operator
\begin_inset Formula 
\[
L=\left[\begin{array}{cc}
0 & x\\
-x & 0
\end{array}\right]
\]

\end_inset


\begin_inset Formula 
\[
\exp(L)U_{0}=\sum_{n}\beta_{n}\left(L+\alpha_{n}\right)^{-1}U_{0}
\]

\end_inset

where
\begin_inset Formula 
\[
U_{0}=[Re(u_{0}),Im(u_{0})].
\]

\end_inset


\end_layout

\begin_layout Standard
We test with two different initial conditions:
\end_layout

\begin_layout Itemize
\begin_inset Formula $u_{0}=1.0$
\end_inset

:
\begin_inset Newline newline
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Merging
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
merge
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
merge
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Halve
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
halve
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
halve
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Resulting REXI setup
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta^{Re}$
\end_inset

 only
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
merge 
\begin_inset Formula $\beta^{Re}$
\end_inset

 
\series default
and
\series bold
 
\begin_inset Formula $\beta^{Im}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
halve
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
merge+halve
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Re\left(\exp(ix)\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\exp(ix)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Re(\exp(L))$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Neither merging, nor halving: Only the real values of the ODE are solved
 properly.
\end_layout

\begin_layout Itemize
Merging only: Results in a successful execution for all test cases.
\end_layout

\begin_layout Itemize
Only halving: Full failure, in particular because the real-valued property
 of the linear operator is failing
\end_layout

\begin_layout Itemize
merge + halve: Only works for linear operator 
\begin_inset Formula $L$
\end_inset

 which is the only real-valued one.
\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Formula $u0=(1+2j)/\sqrt{5}$
\end_inset

:
\begin_inset Newline newline
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Merging
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
merge
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
merge
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Halve
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
halve
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
halve
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Resulting REXI setup
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta^{Re}$
\end_inset

 only
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
merge 
\begin_inset Formula $\beta^{Re}$
\end_inset

 
\series default
and
\series bold
 
\begin_inset Formula $\beta^{Im}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
halve
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
merge+halve
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Re\left(\exp(ix)\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\exp(ix)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Re(\exp(L))$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Neither merging, nor halving: Even the real approximation now failes.
 The reason for this is that a correct approximation of the imaginary value
 of 
\begin_inset Formula $\exp(ix)$
\end_inset

 is required.
\end_layout

\begin_layout Itemize
All other benchmarks behave as expected.
\end_layout

\end_deeper
\begin_layout Section
Filtering
\end_layout

\begin_layout Standard
To ensure that the REXI is bounded by unit, a filtering process is proposed
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Terry:High-order time-parallel approximation of evolution operators"
literal "true"

\end_inset

.
 REXI is prone to exceed unit in the neighborhood of 
\begin_inset Formula $|t\lambda|\approx hM$
\end_inset

, therefore in the highest frequencies.
 The idea is to construct a rational function 
\begin_inset Formula $S(ix)$
\end_inset

 that is approximately 
\begin_inset Formula $1$
\end_inset

 in a smaller interval 
\begin_inset Formula $|t\lambda|<hM_{0}$
\end_inset

, with 
\begin_inset Formula $M_{0}<M$
\end_inset

, and decays very fast to zero outside this interval.
 This filter can be applied as a separate 
\begin_inset Quotes eld
\end_inset

time step
\begin_inset Quotes erd
\end_inset

 to get rid of such fast modes.
\end_layout

\begin_layout Section
Bringing everything together
\end_layout

\begin_layout Standard
Using the spectral methods (e.g.
 in SWEET), we can directly solve the Helmholtz problem for the height and
 then solver for the velocity.
 Note that the Helmholtz problem is in complex space, as 
\begin_inset Formula $\alpha_{n}$
\end_inset

 are complex.
 This is straightforward with spectral methods.
 For finite difference/element methods, the problem can be split into its
 real and imaginary parts.
\end_layout

\begin_layout Standard
Then, the problem is reduced to computing the REXI as given in Eq.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rexi"

\end_inset

.
 
\end_layout

\begin_layout Section
Notes on HPC
\end_layout

\begin_layout Itemize
The terms in REXI to solve are all independent.
 Hence, for latency avoiding, the communication can be interleaved with
 computations.
 
\end_layout

\begin_layout Itemize
The iterative solvers are memory bound.
 Instead of computing 
\begin_inset Formula $c:=a*b$
\end_inset

 for the stencil operations, we could compute 
\begin_inset Formula $\vec{c}:=a\vec{b}$
\end_inset

 with 
\begin_inset Formula $a$
\end_inset

 one coefficient in the stencil.
 This allows vectorization over 
\begin_inset Formula $c$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 on accelerator cards with strided memory access.
 
\end_layout

\begin_layout Itemize
It is unknown which method is more efficient to solve the system of equations:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
iterative solvers have low memory access,
\end_layout

\begin_layout Itemize
inverting the system and storing it as a sparse matrix allows fast direct
 solving but can yield more memory access operations.
\end_layout

\end_deeper
\begin_layout Itemize
Splitting the solver into real and complex number would store them consecutively
 in memory.
 This has a potential to avoid non-strided memory access and using the same
 SIMD operations (Just a rough idea, TODO: check if this is really the case).
\end_layout

\begin_layout Section
Acknowledgements
\end_layout

\begin_layout Standard
Thanks to Terry for the feedback & discussions! 
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Schreiber:Formulations of the shallow-water equations"
literal "true"

\end_inset

Formulations of the shallow-water equations, M.
 Schreiber, P.
 Peixoto et al.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Terry:High-order time-parallel approximation of evolution operators"
literal "true"

\end_inset

High-order time-parallel approximation of evolution operators, T.
 Haut et al.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Moler:Nineteen Dubious Ways to Compute the Exponential of a Matrix"
literal "true"

\end_inset

Nineteen Dubious Ways to Compute the Exponential of a Matrix, Twenty-Five
 Years Later, Cleve Moler and Charles Van Loan, SIAM review
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Damle:Near optimal rational approximations of large data sets"
literal "true"

\end_inset

Near optimal rational approximations of large data sets, Damle, A., Beylkin,
 G., Haut, T.
 S.
 & Monzon
\end_layout

\end_body
\end_document
